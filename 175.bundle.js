"use strict";(self.webpackChunkcollaborative_note_taking_app=self.webpackChunkcollaborative_note_taking_app||[]).push([[175],{175:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var a=n(4848),i=n(6540),o=n(2096),r=n(7606),s=n(3182),l=n(5834),c=n(3608),d=n(2460),u=n(3615),p=n(8826),g=n(6746),f=n(7315),v=n(944);n(1392),n(8127);v.A.apps.length||v.A.initializeApp({apiKey:"AIzaSyCs1dXhSoIe9fretf-Tn38XSbsSGyzDxes",authDomain:"collaborative-note-taking-app1.firebaseapp.com",projectId:"collaborative-note-taking-app1",storageBucket:"collaborative-note-taking-app1.appspot.com",messagingSenderId:"504934917091",appId:"1:504934917091:web:87056f4980cbcba5f7f6d6",measurementId:"G-R34PEFWXXR"});const m=v.A.firestore(),h=v.A.auth();h.onAuthStateChanged((e=>{if(e){const t=m.collection("presence").doc(e.uid),n={state:"offline",last_changed:v.A.firestore.FieldValue.serverTimestamp()},a={state:"online",last_changed:v.A.firestore.FieldValue.serverTimestamp()};v.A.firestore().doc(".info/connected").onSnapshot((e=>{!1!==e.data().state?t.set(a):t.set(n)})),window.addEventListener("beforeunload",(()=>{t.set(n)}))}}));var A=function(){return A=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},A.apply(this,arguments)},x=(0,o.A)((function(e){return{button:{marginTop:e.spacing(2)},flexContainer:{display:"flex",gap:e.spacing(1),flexWrap:"wrap",marginTop:e.spacing(1)},noteContainer:{display:"flex",alignItems:"center",gap:e.spacing(1)},editingIndicator:{marginTop:e.spacing(1)},textField:{backgroundColor:e.palette.background.paper,color:e.palette.text.primary}}}));const b=function(){var e=(0,i.useState)([]),t=e[0],n=e[1],o=(0,i.useState)(!0),b=o[0],y=o[1],j=(0,i.useState)(null),k=j[0],C=j[1],S=x();return(0,i.useEffect)((function(){var e=m.collection("notes").orderBy("timestamp","asc").onSnapshot((function(e){var t=e.docs.map((function(e){return{id:e.id,content:e.data().content||"",tags:e.data().tags||[],editingUsers:e.data().editingUsers||[]}}));n(t),y(!1)}));return h.onAuthStateChanged((function(e){C(e?e.uid:null)})),function(){return e()}}),[]),(0,a.jsxs)(r.A,A({container:!0,spacing:2},{children:[b&&(0,a.jsx)(s.A,{}),t.map((function(e){return(0,a.jsx)(l.A,A({in:!b},{children:(0,a.jsxs)(r.A,A({item:!0,xs:12,sm:6,md:4},{children:[(0,a.jsxs)("div",A({className:S.noteContainer},{children:[(0,a.jsx)(c.A,{fullWidth:!0,variant:"outlined",value:e.content,onChange:function(t){return n=e.id,a=t.target.value,void m.collection("notes").doc(n).update({content:a});var n,a},"aria-label":"Note content",inputProps:{style:{color:"#333"}},onFocus:function(){return t=e.id,void(k&&m.collection("notes").doc(t).update({editingUsers:v.A.firestore.FieldValue.arrayUnion(k)}));var t},onBlur:function(){return t=e.id,void(k&&m.collection("notes").doc(t).update({editingUsers:v.A.firestore.FieldValue.arrayRemove(k)}));var t},className:S.textField}),(0,a.jsx)(d.A,A({"aria-label":"Delete note",onClick:function(){return t=e.id,void m.collection("notes").doc(t).delete();var t}},{children:(0,a.jsx)(f.A,{})}))]})),(0,a.jsxs)("div",A({className:S.flexContainer},{children:[e.tags.map((function(t,n){return(0,a.jsx)(u.A,{label:t,onDelete:function(){return n=e.id,a=t,void m.collection("notes").doc(n).update({tags:v.A.firestore.FieldValue.arrayRemove(a)});var n,a}},n)})),(0,a.jsx)(c.A,{variant:"outlined",size:"small",placeholder:"Add tag",onKeyDown:function(t){var n,a;"Enter"===t.key&&(n=e.id,a=t.target.value,m.collection("notes").doc(n).update({tags:v.A.firestore.FieldValue.arrayUnion(a)}),t.target.value="")}})]})),e.editingUsers.length>0&&(0,a.jsx)("div",A({className:S.editingIndicator},{children:(0,a.jsx)(p.Ay,A({title:"Currently editing"},{children:(0,a.jsx)(u.A,{label:"Editing by ".concat(e.editingUsers.length," user(s)"),color:"secondary"})}))}))]}))}),e.id)})),(0,a.jsx)(r.A,A({item:!0,xs:12},{children:(0,a.jsx)(g.A,A({variant:"contained",color:"primary",onClick:function(){m.collection("notes").add({content:"",tags:[],editingUsers:[],timestamp:v.A.firestore.FieldValue.serverTimestamp()})},className:S.button,"aria-label":"Add note"},{children:"Add Note"}))}))]}))}}}]);