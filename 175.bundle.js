"use strict";(self.webpackChunkcollaborative_note_taking_app=self.webpackChunkcollaborative_note_taking_app||[]).push([[175],{175:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var a=n(4848),i=n(6540),o=n(2096),r=n(7606),s=n(3182),c=n(5834),l=n(3608),d=n(2460),u=n(3615),p=n(8826),f=n(6746),g=n(7315),v=n(944);n(1392),n(8127);v.A.apps.length||v.A.initializeApp({apiKey:"AIzaSyCs1dXhSoIe9fretf-Tn38XSbsSGyzDxes",authDomain:"collaborative-note-taking-app1.firebaseapp.com",projectId:"collaborative-note-taking-app1",storageBucket:"collaborative-note-taking-app1.appspot.com",messagingSenderId:"504934917091",appId:"1:504934917091:web:87056f4980cbcba5f7f6d6",measurementId:"G-R34PEFWXXR"});const h=v.A.firestore(),m=v.A.auth();m.onAuthStateChanged((e=>{if(e){const t=h.collection("presence").doc(e.uid),n={state:"offline",last_changed:v.A.firestore.FieldValue.serverTimestamp()},a={state:"online",last_changed:v.A.firestore.FieldValue.serverTimestamp()};v.A.firestore().doc(".info/connected").onSnapshot((e=>{!1!==e.data().state?t.set(a):t.set(n)})),window.addEventListener("beforeunload",(()=>{t.set(n)}))}}));var A=function(){return A=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},A.apply(this,arguments)},x=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,o=t.length;i<o;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},b=(0,o.A)((function(e){return{button:{marginTop:e.spacing(2)},flexContainer:{display:"flex",gap:"8px",flexWrap:"wrap",marginTop:e.spacing(1)},noteContainer:{display:"flex",alignItems:"center",gap:"8px"},editingIndicator:{marginTop:e.spacing(1)}}}));const y=function(){var e=(0,i.useState)([]),t=e[0],n=e[1],o=(0,i.useState)(!0),y=o[0],j=o[1],k=(0,i.useState)(null),C=k[0],S=k[1],I=b();(0,i.useEffect)((function(){var e=h.collection("notes").orderBy("timestamp","asc").onSnapshot((function(e){var t=e.docs.map((function(e){return{id:e.id,content:e.data().content||"",tags:e.data().tags||[],editingUsers:e.data().editingUsers||[]}}));n(t),j(!1)}));return m.onAuthStateChanged((function(e){S(e?e.uid:null)})),function(){return e()}}),[]);var w=function(e,t,n){h.collection("notes").doc(e).update({content:t,tags:n})};return(0,a.jsxs)(r.A,A({container:!0,spacing:2},{children:[y&&(0,a.jsx)(s.A,{}),t.map((function(e){return(0,a.jsx)(c.A,A({in:!y},{children:(0,a.jsxs)(r.A,A({item:!0,xs:12,sm:6,md:4},{children:[(0,a.jsxs)("div",A({className:I.noteContainer},{children:[(0,a.jsx)(l.A,{fullWidth:!0,variant:"outlined",value:e.content,onChange:function(t){return w(e.id,t.target.value,e.tags)},"aria-label":"Note content",inputProps:{style:{color:"#333"}},onFocus:function(){return t=e.id,void(C&&h.collection("notes").doc(t).update({editingUsers:v.A.firestore.FieldValue.arrayUnion(C)}));var t},onBlur:function(){return t=e.id,void(C&&h.collection("notes").doc(t).update({editingUsers:v.A.firestore.FieldValue.arrayRemove(C)}));var t}}),(0,a.jsx)(d.A,A({"aria-label":"Delete note",onClick:function(){return t=e.id,void h.collection("notes").doc(t).delete();var t}},{children:(0,a.jsx)(g.A,{})}))]})),(0,a.jsxs)("div",A({className:I.flexContainer},{children:[e.tags.map((function(n,i){return(0,a.jsx)(u.A,{label:n,onDelete:function(){return function(e,n){var a=t.find((function(t){return t.id===e}));if(a){var i=a.tags.filter((function(e){return e!==n}));w(e,a.content,i)}}(e.id,n)}},i)})),(0,a.jsx)(l.A,{variant:"outlined",size:"small",placeholder:"Add tag",onKeyDown:function(n){"Enter"===n.key&&(function(e,n){var a=t.find((function(t){return t.id===e}));if(a){var i=x(x([],a.tags,!0),[n],!1);w(e,a.content,i)}}(e.id,n.target.value),n.target.value="")}})]})),e.editingUsers.length>0&&(0,a.jsx)("div",A({className:I.editingIndicator},{children:(0,a.jsx)(p.Ay,A({title:"Currently editing"},{children:(0,a.jsx)(u.A,{label:"Editing by ".concat(e.editingUsers.length," user(s)"),color:"secondary"})}))}))]}))}),e.id)})),(0,a.jsx)(r.A,A({item:!0,xs:12},{children:(0,a.jsx)(f.A,A({variant:"contained",color:"primary",onClick:function(){h.collection("notes").add({content:"",tags:[],editingUsers:[],timestamp:v.A.firestore.FieldValue.serverTimestamp()})},className:I.button,"aria-label":"Add note"},{children:"Add Note"}))}))]}))}}}]);