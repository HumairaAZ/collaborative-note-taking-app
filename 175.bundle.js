"use strict";(self.webpackChunkcollaborative_note_taking_app=self.webpackChunkcollaborative_note_taking_app||[]).push([[175],{175:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var i=n(4848),a=n(6540),o=n(2096),r=n(7606),s=n(3182),c=n(5834),l=n(3608),d=n(2460),u=n(8826),p=n(6746),f=n(7315),g=n(944);n(1392),n(8127);g.A.apps.length||g.A.initializeApp({apiKey:"AIzaSyCs1dXhSoIe9fretf-Tn38XSbsSGyzDxes",authDomain:"collaborative-note-taking-app1.firebaseapp.com",projectId:"collaborative-note-taking-app1",storageBucket:"collaborative-note-taking-app1.appspot.com",messagingSenderId:"504934917091",appId:"1:504934917091:web:87056f4980cbcba5f7f6d6",measurementId:"G-R34PEFWXXR"});const h=g.A.firestore(),m=g.A.auth();m.onAuthStateChanged((e=>{if(e){const t=h.collection("presence").doc(e.uid),n={state:"offline",last_changed:g.A.firestore.FieldValue.serverTimestamp()},i={state:"online",last_changed:g.A.firestore.FieldValue.serverTimestamp()};g.A.firestore().doc(".info/connected").onSnapshot((e=>{!1!==e.data().state?t.set(i):t.set(n)})),window.addEventListener("beforeunload",(()=>{t.set(n)}))}}));var v=function(){return v=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},v.apply(this,arguments)},A=(0,o.A)((function(e){return{button:{marginTop:e.spacing(2)},noteContainer:{display:"flex",alignItems:"center",gap:e.spacing(1)},editingIndicator:{marginTop:e.spacing(1)},textField:{backgroundColor:e.palette.background.paper,color:e.palette.text.primary}}}));const b=function(){var e=(0,a.useState)([]),t=e[0],n=e[1],o=(0,a.useState)(!0),b=o[0],x=o[1],j=(0,a.useState)(null),y=j[0],k=j[1],C=A();return(0,a.useEffect)((function(){var e=h.collection("notes").orderBy("timestamp","asc").onSnapshot((function(e){var t=e.docs.map((function(e){return{id:e.id,content:e.data().content||"",editingUsers:e.data().editingUsers||[]}}));n(t),x(!1)}));return m.onAuthStateChanged((function(e){k(e?e.uid:null)})),function(){return e()}}),[]),(0,i.jsxs)(r.A,v({container:!0,spacing:2},{children:[b&&(0,i.jsx)(s.A,{}),t.map((function(e){return(0,i.jsx)(c.A,v({in:!b},{children:(0,i.jsxs)(r.A,v({item:!0,xs:12,sm:6,md:4},{children:[(0,i.jsxs)("div",v({className:C.noteContainer},{children:[(0,i.jsx)(l.A,{fullWidth:!0,variant:"outlined",value:e.content,onChange:function(t){return n=e.id,i=t.target.value,void h.collection("notes").doc(n).update({content:i});var n,i},"aria-label":"Note content",inputProps:{style:{color:"#333"}},onFocus:function(){return t=e.id,void(y&&h.collection("notes").doc(t).update({editingUsers:g.A.firestore.FieldValue.arrayUnion(y)}));var t},onBlur:function(){return t=e.id,void(y&&h.collection("notes").doc(t).update({editingUsers:g.A.firestore.FieldValue.arrayRemove(y)}));var t},className:C.textField}),(0,i.jsx)(d.A,v({"aria-label":"Delete note",onClick:function(){return t=e.id,void h.collection("notes").doc(t).delete();var t}},{children:(0,i.jsx)(f.A,{})}))]})),e.editingUsers.length>0&&(0,i.jsx)("div",v({className:C.editingIndicator},{children:(0,i.jsx)(u.Ay,v({title:"Currently editing"},{children:(0,i.jsxs)("span",{children:["Editing by ",e.editingUsers.length," user(s)"]})}))}))]}))}),e.id)})),(0,i.jsx)(r.A,v({item:!0,xs:12},{children:(0,i.jsx)(p.A,v({variant:"contained",color:"primary",onClick:function(){h.collection("notes").add({content:"",editingUsers:[],timestamp:g.A.firestore.FieldValue.serverTimestamp()})},className:C.button,"aria-label":"Add note"},{children:"Add Note"}))}))]}))}}}]);